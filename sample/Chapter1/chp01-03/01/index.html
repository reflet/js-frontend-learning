<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>オブザーバー（１）</title>
    <style type="text/css">
      p { padding:0; margin:0; }
      pre { border:solid 1px #ccc; background-color:#eee; }
    </style>
  </head>
  <body>
    <script src="app.js"></script>
    <h1>Chapter-01-03 01</h1>
    <p>オブザーバー（１）</p>
    <p>オブザーバーとは、JavaScriptデザインパターンの一種です。</p>
    <p>オブザーバーは、状態の変化を監視することを目的としたものです。</p>
    <p>あるオブジェクトの状態が変化した際に、あらかじめ登録しておいた監視者に対して通知を行います。</p>
    <pre>
      <code>
        function Observer() {
          this.listeners = [];
        }

        Observer.prototype.on = function(func) {
          this.listeners.push(func);
        };

        Observer.prototype.off = function(func) {
          var len = this.listener.length;
          for (var i = 0; i < len; i++) {
            var listener = this.listeners[i];
            if (listener === func) {
              this.listeners.splice(i, 1);
            }
          }
        };

        Observer.prototype.trigger = function() {
          var len = this.listeners.length;
          for (var i = 0; i < len; i++) {
            var listener = this.listeners[i];
            listener();
          }
        };

        var observer = new Observer();
        var greet = function () {
          console.log("Good morning");
        };
        observer.on(greet);
        observer.trigger(); // Good morning
      </code>
    </pre>
  </body>
</html>
